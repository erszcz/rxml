^[[A21:19:46 erszcz @ x2 : ~/work/esl/exml (master %)
$ erl -pa ebin/
Erlang/OTP 18 [erts-7.1] [source] [64-bit] [smp:8:8] [async-threads:10] [hipe] [kernel-poll:false]

Eshell V7.1  (abort with ^G)
1> rd(xmlel, {name, attrs, children}).
xmlel
2> dbg:tracer().
{ok,<0.44.0>}
3> dbg:p(all, call).
{ok,[{matched,nonode@nohost,29}]}
4> dbg:tpl(exml_stream, parse_events, x).
{ok,[{matched,nonode@nohost,1},{saved,x}]}
5> {ok, Parser0} = exml_stream:new_parser().
{ok,{parser,<<>>,{config,false,false},[]}}
6> {ok, Parser1, Empty0} =
6>     exml_stream:parse(Parser0, <<"<stream:stream xmlns:stream='http://etherx.jabber.org/streams' version='1.0'">>).
(<0.41.0>) call exml_stream:parse_events([],[],[],false)
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[],[]}
{ok,{parser,<<>>,{config,false,false},[]},[]}
7> {ok, Parser2, StreamStart} =
7>     exml_stream:parse(Parser1, <<" to='i.am.banana.com' xml:lang='en'><auth">>).
(<0.41.0>) call exml_stream:parse_events([{xml_element_start,<<"stream:stream">>,
                    [{<<"http://etherx.jabber.org/streams">>,<<"stream">>}],
                    [{<<"version">>,<<"1.0">>},
                     {<<"to">>,<<"i.am.banana.com">>},
                     {<<"xml:lang">>,<<"en">>}]}],[],[],false)
(<0.41.0>) call exml_stream:parse_events([],[{xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[{xmlstreamstart,<<"stream:stream">>,
                 [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
                  {<<"version">>,<<"1.0">>},
                  {<<"to">>,<<"i.am.banana.com">>},
                  {<<"xml:lang">>,<<"en">>}]}],false)
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[{xmlstreamstart,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}]}],
                                                        [{xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[{xmlstreamstart,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}]}],
                                                        [{xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
{ok,{parser,<<>>,
            {config,false,false},
            [#xmlel{name = <<"stream:stream">>,
                    attrs = [{<<"xmlns:stream">>,
                              <<"http://etherx.jabber.org/streams">>},
                             {<<"version">>,<<"1.0">>},
                             {<<"to">>,<<"i.am.banana.com">>},
                             {<<"xml:lang">>,<<"en">>}],
                    children = []}]},
    [{xmlstreamstart,<<"stream:stream">>,
                     [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
                      {<<"version">>,<<"1.0">>},
                      {<<"to">>,<<"i.am.banana.com">>},
                      {<<"xml:lang">>,<<"en">>}]}]}
8> {ok, Parser3, Auth} = exml_stream:parse(Parser2, <<" mechanism='DIGEST-MD5'/>">>).
(<0.41.0>) call exml_stream:parse_events([{xml_element_start,<<"auth">>,[],[{<<"mechanism">>,<<"DIGEST-MD5">>}]},
 {xml_element_end,<<"auth">>}],[{xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) call exml_stream:parse_events([{xml_element_end,<<"auth">>}],[{xmlel,<<"auth">>,[{<<"mechanism">>,<<"DIGEST-MD5">>}],[]},
 {xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) call exml_stream:parse_events([],[{xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[{xmlel,<<"auth">>,[{<<"mechanism">>,<<"DIGEST-MD5">>}],[]}],false)
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[{xmlel,<<"auth">>,
                                                          [{<<"mechanism">>,
                                                            <<"DIGEST-MD5">>}],
                                                          []}],
                                                        [{xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[{xmlel,<<"auth">>,
                                                          [{<<"mechanism">>,
                                                            <<"DIGEST-MD5">>}],
                                                          []}],
                                                        [{xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[{xmlel,<<"auth">>,
                                                          [{<<"mechanism">>,
                                                            <<"DIGEST-MD5">>}],
                                                          []}],
                                                        [{xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
{ok,{parser,<<>>,
            {config,false,false},
            [#xmlel{name = <<"stream:stream">>,
                    attrs = [{<<"xmlns:stream">>,
                              <<"http://etherx.jabber.org/streams">>},
                             {<<"version">>,<<"1.0">>},
                             {<<"to">>,<<"i.am.banana.com">>},
                             {<<"xml:lang">>,<<"en">>}],
                    children = []}]},
    [#xmlel{name = <<"auth">>,
            attrs = [{<<"mechanism">>,<<"DIGEST-MD5">>}],
            children = []}]}
9> {ok, Parser4, Empty1} = exml_stream:parse(Parser3, <<"<stream:features><bind xmlns='some_ns'">>).
(<0.41.0>) call exml_stream:parse_events([{xml_element_start,<<"stream:features">>,[],[]}],[{xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) call exml_stream:parse_events([],[{xmlel,<<"stream:features">>,[],[]},
 {xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[],
                                                        [{xmlel,
                                                          <<"stream:features">>,
                                                          [],[]},
                                                         {xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[],
                                                        [{xmlel,
                                                          <<"stream:features">>,
                                                          [],[]},
                                                         {xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
{ok,{parser,<<>>,
            {config,false,false},
            [#xmlel{name = <<"stream:features">>,attrs = [],
                    children = []},
             #xmlel{name = <<"stream:stream">>,
                    attrs = [{<<"xmlns:stream">>,
                              <<"http://etherx.jabber.org/streams">>},
                             {<<"version">>,<<"1.0">>},
                             {<<"to">>,<<"i.am.banana.com">>},
                             {<<"xml:lang">>,<<"en">>}],
                    children = []}]},
    []}
10> {ok, Parser5, Empty2} = exml_stream:parse(Parser4, <<"/><session xmlns='some_other'/>This is ">>).
(<0.41.0>) call exml_stream:parse_events([{xml_element_start,<<"bind">>,[{<<"some_ns">>,none}],[]},
 {xml_element_end,<<"bind">>},
 {xml_element_start,<<"session">>,[{<<"some_other">>,none}],[]},
 {xml_element_end,<<"session">>},
 {xml_cdata,<<"This is ">>}],[{xmlel,<<"stream:features">>,[],[]},
 {xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) call exml_stream:parse_events([{xml_element_end,<<"bind">>},
 {xml_element_start,<<"session">>,[{<<"some_other">>,none}],[]},
 {xml_element_end,<<"session">>},
 {xml_cdata,<<"This is ">>}],[{xmlel,<<"bind">>,[{<<"xmlns">>,<<"some_ns">>}],[]},
 {xmlel,<<"stream:features">>,[],[]},
 {xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) call exml_stream:parse_events([{xml_element_start,<<"session">>,[{<<"some_other">>,none}],[]},
 {xml_element_end,<<"session">>},
 {xml_cdata,<<"This is ">>}],[{xmlel,<<"stream:features">>,[],
        [{xmlel,<<"bind">>,[{<<"xmlns">>,<<"some_ns">>}],[]}]},
 {xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) call exml_stream:parse_events([{xml_element_end,<<"session">>},{xml_cdata,<<"This is ">>}],[{xmlel,<<"session">>,[{<<"xmlns">>,<<"some_other">>}],[]},
 {xmlel,<<"stream:features">>,[],
        [{xmlel,<<"bind">>,[{<<"xmlns">>,<<"some_ns">>}],[]}]},
 {xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) call exml_stream:parse_events([{xml_cdata,<<"This is ">>}],[{xmlel,<<"stream:features">>,[],
        [{xmlel,<<"session">>,[{<<"xmlns">>,<<"some_other">>}],[]},
         {xmlel,<<"bind">>,[{<<"xmlns">>,<<"some_ns">>}],[]}]},
 {xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) call exml_stream:parse_events([],[{xmlel,<<"stream:features">>,[],
        [{xmlcdata,<<"This is ">>},
         {xmlel,<<"session">>,[{<<"xmlns">>,<<"some_other">>}],[]},
         {xmlel,<<"bind">>,[{<<"xmlns">>,<<"some_ns">>}],[]}]},
 {xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[],
                                                        [{xmlel,
                                                          <<"stream:features">>,
                                                          [],
                                                          [{xmlcdata,
                                                            <<"This is ">>},
                                                           {xmlel,
                                                            <<"session">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_other">>}],
                                                            []},
                                                           {xmlel,<<"bind">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_ns">>}],
                                                            []}]},
                                                         {xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[],
                                                        [{xmlel,
                                                          <<"stream:features">>,
                                                          [],
                                                          [{xmlcdata,
                                                            <<"This is ">>},
                                                           {xmlel,
                                                            <<"session">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_other">>}],
                                                            []},
                                                           {xmlel,<<"bind">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_ns">>}],
                                                            []}]},
                                                         {xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[],
                                                        [{xmlel,
                                                          <<"stream:features">>,
                                                          [],
                                                          [{xmlcdata,
                                                            <<"This is ">>},
                                                           {xmlel,
                                                            <<"session">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_other">>}],
                                                            []},
                                                           {xmlel,<<"bind">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_ns">>}],
                                                            []}]},
                                                         {xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[],
                                                        [{xmlel,
                                                          <<"stream:features">>,
                                                          [],
                                                          [{xmlcdata,
                                                            <<"This is ">>},
                                                           {xmlel,
                                                            <<"session">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_other">>}],
                                                            []},
                                                           {xmlel,<<"bind">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_ns">>}],
                                                            []}]},
                                                         {xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[],
                                                        [{xmlel,
                                                          <<"stream:features">>,
                                                          [],
                                                          [{xmlcdata,
                                                            <<"This is ">>},
                                                           {xmlel,
                                                            <<"session">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_other">>}],
                                                            []},
                                                           {xmlel,<<"bind">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_ns">>}],
                                                            []}]},
                                                         {xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[],
                                                        [{xmlel,
                                                          <<"stream:features">>,
                                                          [],
                                                          [{xmlcdata,
                                                            <<"This is ">>},
                                                           {xmlel,
                                                            <<"session">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_other">>}],
                                                            []},
                                                           {xmlel,<<"bind">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_ns">>}],
                                                            []}]},
                                                         {xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
{ok,{parser,<<>>,
            {config,false,false},
            [#xmlel{name = <<"stream:features">>,attrs = [],
                    children = [{xmlcdata,<<"This is ">>},
                                #xmlel{name = <<"session">>,
                                       attrs = [{<<"xmlns">>,<<"some_other">>}],
                                       children = []},
                                #xmlel{name = <<"bind">>,
                                       attrs = [{<<"xmlns">>,<<"some_ns">>}],
                                       children = []}]},
             #xmlel{name = <<"stream:stream">>,
                    attrs = [{<<"xmlns:stream">>,
                              <<"http://etherx.jabber.org/streams">>},
                             {<<"version">>,<<"1.0">>},
                             {<<"to">>,<<"i.am.banana.com">>},
                             {<<"xml:lang">>,<<"en">>}],
                    children = []}]},
    []}
11> {ok, Parser6, Features} = exml_stream:parse(Parser5, <<"some CData</stream:features>">>).
(<0.41.0>) call exml_stream:parse_events([{xml_cdata,<<"some CData">>},{xml_element_end,<<"stream:features">>}],[{xmlel,<<"stream:features">>,[],
        [{xmlcdata,<<"This is ">>},
         {xmlel,<<"session">>,[{<<"xmlns">>,<<"some_other">>}],[]},
         {xmlel,<<"bind">>,[{<<"xmlns">>,<<"some_ns">>}],[]}]},
 {xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) call exml_stream:parse_events([{xml_element_end,<<"stream:features">>}],[{xmlel,<<"stream:features">>,[],
        [{xmlcdata,<<"This is some CData">>},
         {xmlel,<<"session">>,[{<<"xmlns">>,<<"some_other">>}],[]},
         {xmlel,<<"bind">>,[{<<"xmlns">>,<<"some_ns">>}],[]}]},
 {xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[],false)
(<0.41.0>) call exml_stream:parse_events([],[{xmlel,<<"stream:stream">>,
        [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
         {<<"version">>,<<"1.0">>},
         {<<"to">>,<<"i.am.banana.com">>},
         {<<"xml:lang">>,<<"en">>}],
        []}],[{xmlel,<<"stream:features">>,[],
        [{xmlel,<<"bind">>,[{<<"xmlns">>,<<"some_ns">>}],[]},
         {xmlel,<<"session">>,[{<<"xmlns">>,<<"some_other">>}],[]},
         {xmlcdata,<<"This is some CData">>}]}],false)
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[{xmlel,
                                                          <<"stream:features">>,
                                                          [],
                                                          [{xmlel,<<"bind">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_ns">>}],
                                                            []},
                                                           {xmlel,
                                                            <<"session">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_other">>}],
                                                            []},
                                                           {xmlcdata,
                                                            <<"This is some CData">>}]}],
                                                        [{xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[{xmlel,
                                                          <<"stream:features">>,
                                                          [],
                                                          [{xmlel,<<"bind">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_ns">>}],
                                                            []},
                                                           {xmlel,
                                                            <<"session">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_other">>}],
                                                            []},
                                                           {xmlcdata,
                                                            <<"This is some CData">>}]}],
                                                        [{xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
(<0.41.0>) returned from exml_stream:parse_events/4 -> {[{xmlel,
                                                          <<"stream:features">>,
                                                          [],
                                                          [{xmlel,<<"bind">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_ns">>}],
                                                            []},
                                                           {xmlel,
                                                            <<"session">>,
                                                            [{<<"xmlns">>,
                                                              <<"some_other">>}],
                                                            []},
                                                           {xmlcdata,
                                                            <<"This is some CData">>}]}],
                                                        [{xmlel,
                                                          <<"stream:stream">>,
                                                          [{<<"xmlns:stream">>,
                                                            <<"http://etherx.jabber.org/streams">>},
                                                           {<<"version">>,
                                                            <<"1.0">>},
                                                           {<<"to">>,
                                                            <<"i.am.banana.com">>},
                                                           {<<"xml:lang">>,
                                                            <<"en">>}],
                                                          []}]}
{ok,{parser,<<>>,
            {config,false,false},
            [#xmlel{name = <<"stream:stream">>,
                    attrs = [{<<"xmlns:stream">>,
                              <<"http://etherx.jabber.org/streams">>},
                             {<<"version">>,<<"1.0">>},
                             {<<"to">>,<<"i.am.banana.com">>},
                             {<<"xml:lang">>,<<"en">>}],
                    children = []}]},
    [#xmlel{name = <<"stream:features">>,attrs = [],
            children = [#xmlel{name = <<"bind">>,
                               attrs = [{<<"xmlns">>,<<"some_ns">>}],
                               children = []},
                        #xmlel{name = <<"session">>,
                               attrs = [{<<"xmlns">>,<<"some_other">>}],
                               children = []},
                        {xmlcdata,<<"This is some CData">>}]}]}
12> [#xmlel{children=[_, _, CData]}] = Features.
[#xmlel{name = <<"stream:features">>,attrs = [],
        children = [#xmlel{name = <<"bind">>,
                           attrs = [{<<"xmlns">>,<<"some_ns">>}],
                           children = []},
                    #xmlel{name = <<"session">>,
                           attrs = [{<<"xmlns">>,<<"some_other">>}],
                           children = []},
                    {xmlcdata,<<"This is some CData">>}]}]
13> {Empty0, StreamStart, Auth, Empty1, Empty2, Features, CData}.
{[],
 [{xmlstreamstart,<<"stream:stream">>,
                  [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
                   {<<"version">>,<<"1.0">>},
                   {<<"to">>,<<"i.am.banana.com">>},
                   {<<"xml:lang">>,<<"en">>}]}],
 [#xmlel{name = <<"auth">>,
         attrs = [{<<"mechanism">>,<<"DIGEST-MD5">>}],
         children = []}],
 [],[],
 [#xmlel{name = <<"stream:features">>,attrs = [],
         children = [#xmlel{name = <<"bind">>,
                            attrs = [{<<"xmlns">>,<<"some_ns">>}],
                            children = []},
                     #xmlel{name = <<"session">>,
                            attrs = [{<<"xmlns">>,<<"some_other">>}],
                            children = []},
                     {xmlcdata,<<"This is some CData">>}]}],
 {xmlcdata,<<"This is some CData">>}}
14> 
14> 
14> Empty0.
[]
15> StreamStart.
[{xmlstreamstart,<<"stream:stream">>,
                 [{<<"xmlns:stream">>,<<"http://etherx.jabber.org/streams">>},
                  {<<"version">>,<<"1.0">>},
                  {<<"to">>,<<"i.am.banana.com">>},
                  {<<"xml:lang">>,<<"en">>}]}]
16> Auth.
[#xmlel{name = <<"auth">>,
        attrs = [{<<"mechanism">>,<<"DIGEST-MD5">>}],
        children = []}]
17> Empty1.
[]
18> Empty2.
[]
19> Features.
[#xmlel{name = <<"stream:features">>,attrs = [],
        children = [#xmlel{name = <<"bind">>,
                           attrs = [{<<"xmlns">>,<<"some_ns">>}],
                           children = []},
                    #xmlel{name = <<"session">>,
                           attrs = [{<<"xmlns">>,<<"some_other">>}],
                           children = []},
                    {xmlcdata,<<"This is some CData">>}]}]
20> CData.
{xmlcdata,<<"This is some CData">>}
21> 
